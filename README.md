# Домашнее задание к занятию "3.3. Операционные системы, лекция 1"

1. Какой системный вызов делает команда cd? В прошлом ДЗ мы выяснили, что cd не является самостоятельной программой, это shell builtin, поэтому запустить strace непосредственно на cd не получится. Тем не менее, вы можете запустить strace на /bin/bash -c 'cd /tmp'. В этом случае вы увидите полный список системных вызовов, которые делает сам bash при старте. Вам нужно найти тот единственный, который относится именно к cd. Обратите внимание, что strace выдаёт результат своей работы в поток stderr, а не в stdout.

`Выполнил команду strace  /bin/bash -c 'cd /tmp' 4>&2 2>&1 1>&4 | grep /tmp в прошлых занятий, где мы научились перенаправлять потоки , перенаправил поток и отсортировал по папке в которую мы направили команду cd в выводе обнаружил chdir("/tmp")`

![image](https://user-images.githubusercontent.com/106814458/175815730-735006bb-d01f-459f-a749-95aaf1eaa4f2.png)

2. Попробуйте использовать команду file на объекты разных типов на файловой системе

`При использовании strace обнаружил путь до файла /usr/share/misc/magic.mgc , также открыв man file прямым текстом было описано что имеено с помощью этого файла команда определяет тип файлов`

3. Предположим, приложение пишет лог в текстовый файл. Этот файл оказался удален (deleted в lsof), однако возможности сигналом сказать приложению переоткрыть файлы или просто перезапустить приложение – нет. Так как приложение продолжает писать в удаленный файл, место на диске постепенно заканчивается. Основываясь на знаниях о перенаправлении потоков предложите способ обнуления открытого удаленного файла (чтобы освободить место на файловой системе).

`Выполнил команду ping 127.0.0.1 > logping.txt , отправил процесс выполняться в фоновом режиме , далее нашел PID команды ping , затем удалил файл  logping.txt, подставив PID в команду sudo ls -l /proc/16176/fd/ нашел нужный нам файловый дескриптор , далее с помощью команды echo "" | sudo tee /proc/16176/fd/1 передал в этот файл "пустоту" тем самым уменьшив его размер`

4. Занимают ли зомби-процессы какие-то ресурсы в ОС (CPU, RAM, IO)?

`Зомби не занимают памяти , но блокируют записи в таблице процессов, размер которой ограничен для каждого пользователя и системы в целом.`

5. В iovisor BCC есть утилита opensnoop.На какие файлы вы увидели вызовы группы open за первую секунду работы утилиты? Воспользуйтесь пакетом bpfcc-tools для Ubuntu 20.04

`Вывод команды sudo opensnoop-bpfcc`

![image](https://user-images.githubusercontent.com/106814458/175975828-defbcc7d-be30-4c88-ad98-88f7f4e6348c.png)

6. Какой системный вызов использует uname -a? Приведите цитату из man по этому системному вызову, где описывается альтернативное местоположение в /proc, где можно узнать версию ядра и релиз ОС.

`uname({sysname="Linux", nodename="UbuntaTEST", ...}) = 0`
`Part of the utsname information is also accessible via /proc/sys/kernel/{ostype, hostname, osrelease, version, domainname}.`

7. Чем отличается последовательность команд через ; и через && в bash? 

`При выполнение  через " ; " команды будут выполняться последовательно , если использовать && то последующие команды будут выполняться только при условии того , что предыдущая команда успешно отработалась`

Есть ли смысл использовать в bash &&, если применить set -e?

`Нет смысла использовать set -e т.к. он делает  тоже самое что и &&`

8. Из каких опций состоит режим bash set -euxo pipefail и почему его хорошо было бы использовать в сценариях?

`set -euxo pipefail — это сокращение от:`

>set -e

>set -u

>set -o pipefail

>set -x

`Опция set -e предписывает bash немедленно завершить работу, если какая-либо команда  имеет ненулевой статус выхода.`

`set -x Включает режим оболочки,при котором все выполненные команды выводятся на терминал.`

`set -u Влияет на переменные.Когда она установлена,ссылка на любую переменную,которую вы предварительно не определили-за исключением $*и $@-является ошибкой и приводит к немедленному завершению программы.`

`set -o pipefail -Эта настройка предотвращает маскировку ошибок в конвейере.Если какая-либо команда в конвейере завершилась неудачно,этот код возврата будет использоваться в качестве кода возврата всего конвейера.По умолчанию кодом возврата конвейера является код возврата последней команды,даже если она выполнилась успешно.`

`set -euxo pipefail хорошо использовать во время проверки скриптов , с этим режимом легче отловить недоработки и ошибки`

9. Используя -o stat для ps, определите, какой наиболее часто встречающийся статус у процессов в системе. В man ps ознакомьтесь (/PROCESS STATE CODES) что значат дополнительные к основной заглавной буквы статуса процессов. Его можно не учитывать при расчете (считать S, Ss или Ssl равнозначными).

`В выводе вижу самые частые статусы Ss - прерывистый сон (ожидание завершения события) и R+ работающий или в очереди выполнения, s- является лидером сессии , + находится в группе процессов переднего плана`







